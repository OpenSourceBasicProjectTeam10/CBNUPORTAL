{% extends "base.html" %}

{% block title %}{{ request.state.title }}{% endblock title %}

{% block content %}
    <h2 class="blind">최신글</h2>

    <div class="schedule_calendar">
        <!-- 일정 관리 입력 폼 -->
        <form action="/schedule/add" method="post">
            <label for="schedule_title">일정 제목:</label>
            <input type="text" id="schedule_title" name="schedule_title" required>
            <label for="schedule_date">일정 날짜:</label>
            <input type="date" id="schedule_date" name="schedule_date" required>
            <button type="submit">일정 추가</button>
        </form>

        <!-- 달력 -->
        <div id="calendar" class="calendar"></div>
    </div>

    <!-- FullCalendar 라이브러리 추가 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.9.0/core/main.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.9.0/daygrid/main.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.9.0/interaction/main.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.9.0/core/main.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.9.0/daygrid/main.min.css" rel="stylesheet" />

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                editable: true,
                selectable: true,
                events: [],
                select: function(info) {
                    var title = prompt('일정 제목:');
                    if (title) {
                        calendar.addEvent({
                            title: title,
                            start: info.startStr,
                            end: info.endStr,
                            allDay: info.allDay
                        });
                    }
                    calendar.unselect();
                }
            });

            calendar.render();
        });
    </script>

    <div class="latest_wr">
        {% for board in boards %}
            <div style="float:left; {{ loop.cycle("", "margin-left:2%", "margin-left:2%") }}" class="lt_wr">
                {{ render_latest_posts(request, 'basic', board.bo_table, 6, 24)|safe }}
            </div>
        {% endfor %}
    </div>
{% endblock content %}
